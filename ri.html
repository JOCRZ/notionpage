<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reverend Insanity - Chapters | NovelWave</title>

  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root{
      --bg:#f5f5f5;
      --card:#fff;
      --text:#222;
      --muted:#666;
      --accent:#222;
      --shadow:rgba(0,0,0,0.08);
      --accent-strong:#4a90e2;
    }
    body.dark{
      --bg:#1e1e1e;
      --card:#2e2e2e;
      --text:#eee;
      --muted:#bbb;
      --accent:#ccc;
      --shadow:rgba(0,0,0,0.4);
      --accent-strong:#4a90e2;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      display:flex;
      flex-direction:column;
      min-height:100vh;
      transition:background .25s, color .25s;
    }

    /* Header */
    header{
      background:var(--card);
      padding:1rem 1.25rem;
      display:flex;
      justify-content:space-between;
      align-items:center;
      box-shadow:0 2px 8px var(--shadow);
      position:sticky;
      top:0;
      z-index:30;
    }
    .logo{font-weight:700; letter-spacing:1px; text-decoration:none; color:var(--text)}
    .theme-toggle{
      background:var(--accent);
      color:#fff;
      border:0;
      border-radius:8px;
      padding:.45rem .85rem;
      cursor:pointer;
      font-weight:600;
    }

    /* Main layout */
    main{max-width:1200px; margin:1rem auto; width:95%; display:flex; gap:1rem; align-items:flex-start; flex-wrap:wrap;}
    /* Left column: novel info + arcs list (on wide) */
    .left{
      flex: 0 0 280px;
      display:flex;
      flex-direction:column;
      gap:1rem;
    }

    .novel-card{
      background:var(--card);
      border-radius:12px;
      padding:1rem;
      box-shadow:0 4px 12px var(--shadow);
      text-align:center;
    }
    .novel-card img{width:175px;height:242px;object-fit:contain;border-radius:8px;display:block;margin:0 auto 0.8rem; background:#ddd}
    .novel-card h1{margin:.1rem 0;font-family:Georgia,serif;font-style:italic;font-size:1.2rem}
    .novel-card p{margin:.4rem 0 0;color:var(--muted); font-style:italic}

    /* Arc list (list view) */
    .arc-list{
      background:var(--card);
      border-radius:12px;
      padding:.75rem;
      box-shadow:0 4px 12px var(--shadow);
    }
    .arc-list h3{margin:0 0 .5rem 0;font-size:1rem}
    .arc-items{display:flex;flex-direction:column;gap:.4rem}
    .arc-item{
      background:transparent;
      border:1px solid rgba(0,0,0,0.06);
      color:var(--text);
      padding:.5rem .75rem;
      border-radius:8px;
      cursor:pointer;
      text-align:left;
      font-weight:600;
    }
    .arc-item:hover{opacity:.9}
    .arc-item.active{
      background:var(--accent-strong);
      color:#fff;
      border-color:var(--accent-strong);
    }
    body.dark .arc-item{border-color:rgba(255,255,255,0.04)}
    body.dark .arc-item:hover{opacity:.95}

    /* Right column: chapter grid and controls */
    .right{flex:1; min-width:320px; display:flex;flex-direction:column; gap:1rem;}

    .controls{
      display:flex;
      gap:.5rem;
      align-items:center;
      justify-content:flex-end;
    }
    .controls .find-row{display:flex; gap:.4rem; align-items:center}
    .search-input{
      width:110px;
      padding:.45rem .6rem;
      border-radius:8px;
      border:1px solid rgba(0,0,0,0.08);
      background:var(--card);
      color:var(--text);
    }
    .control-button{
      background:var(--accent);
      color:#fff;
      border:0;
      padding:.45rem .7rem;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
    }

    /* Chapter grid (original/old view) */
    .chapter-card{
      background:var(--card);
      border-radius:12px;
      padding:1rem;
      box-shadow:0 6px 18px var(--shadow);
    }
    .chapter-grid{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap:.6rem;
    }
    .chapter-link{
      display:block;
      padding:.6rem .4rem;
      background:var(--card);
      border-radius:8px;
      border:1px solid rgba(0,0,0,0.06);
      text-align:center;
      text-decoration:none;
      color:var(--text);
      font-weight:700;
      transition:transform .12s, background .12s, border-color .12s;
      box-shadow:0 2px 6px rgba(0,0,0,0.06);
      font-size:0.9rem;
    }
    .chapter-link:hover{transform:translateY(-4px)}
    .chapter-link.current{ background:var(--accent); color:#fff; border-color:var(--accent); box-shadow:0 6px 12px rgba(0,0,0,0.12); }
    .chapter-link.found{ outline:3px solid var(--accent-strong); box-shadow:0 8px 20px rgba(74,144,226,0.18); }

    /* Footer */
    footer{margin-top:1rem;background:var(--card); padding:.8rem;border-radius:10px; text-align:center; box-shadow:0 3px 8px var(--shadow)}
    footer nav{display:flex; gap:1rem; justify-content:center; align-items:center}
    footer a{color:var(--text); text-decoration:none; display:flex; gap:.5rem; align-items:center; font-weight:600}

    /* Responsive */
    @media (max-width: 900px){
      main{padding:1rem}
      .left{flex:0 0 100%; order:1}
      .right{order:2; width:100%}
      .controls{justify-content:space-between}
      .arc-list{order:0}
    }
  </style>
</head>
<body class="dark">

  <header>
    <a class="logo" href="index.html">NOVELWAVE</a>
    <button id="themeToggle" class="theme-toggle">‚òÄÔ∏è Light Mode</button>
  </header>

  <main>
    <!-- left column: cover + arc list -->
    <div class="left">
      <div class="novel-card" aria-label="novel info">
        <img src="Data/RI.png" alt="Reverend Insanity cover">
        <h1>Reverend Insanity</h1>
        <p>An epic tale of a cunning immortal reborn in a cruel world where strength rules. Follow Fang Yuan's schemes and survival.</p>
      </div>

      <div class="arc-list" aria-label="arc list">
        <h3>Arcs</h3>
        <div class="arc-items">
          <!-- Arc items will be filled by JS -->
        </div>
      </div>
    </div>

    <!-- right column: controls + chapter grid -->
    <div class="right">
      <div class="controls">
        <div class="find-row">
          <input id="searchInput" class="search-input" type="number" min="1" placeholder="Go to #">
          <button id="findBtn" class="control-button">Find</button>
        </div>
      </div>

      <div class="chapter-card">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:.75rem;">
          <strong>Chapters</strong>
          <span style="color:var(--muted); font-weight:600">Total: <span id="totalCount">0</span></span>
        </div>

        <div id="chapterGrid" class="chapter-grid" aria-label="chapter grid">
          <!-- chapter links generated by JS -->
        </div>
      </div>
    </div>
  </main>

  <footer>
    <nav>
      <a href="#" target="_blank"><i class="fab fa-youtube"></i> YouTube</a>
      <a href="#" target="_blank"><i class="fab fa-instagram"></i> Instagram</a>
      <a href="#" target="_blank"><i class="fas fa-mug-hot"></i> Buy Me a Coffee</a>
    </nav>
  </footer>

  <script>
    /********** Theme toggle (persist) **********/
    const body = document.body;
    const themeToggle = document.getElementById('themeToggle');
    const saved = localStorage.getItem('theme');
    if(saved === 'light') body.classList.remove('dark');
    themeToggle.textContent = body.classList.contains('dark') ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
    themeToggle.addEventListener('click', () => {
      body.classList.toggle('dark');
      localStorage.setItem('theme', body.classList.contains('dark') ? 'dark' : 'light');
      themeToggle.textContent = body.classList.contains('dark') ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
    });

    /********** Chapter & Arc data **********/
    // You can change totalChapters to the real number (100 etc.)
    const totalChapters = 100;
    const currentChapter = 57; // if you want to mark a "current" one
    document.getElementById('totalCount').textContent = totalChapters;

    // define arcs as ranges (you can edit ranges)
    const arcs = [
      { id:1, name:'Arc 1', start:1, end:34 },
      { id:2, name:'Arc 2', start:35, end:67 },
      { id:3, name:'Arc 3', start:68, end:100 }
    ];

    /********** Generate chapter grid (old style) **********/
    const chapterGrid = document.getElementById('chapterGrid');

    function buildGrid(start=1, end=totalChapters){
      chapterGrid.innerHTML = '';
      for(let i=start;i<=end;i++){
        const a = document.createElement('a');
        a.href = `chapters/chapter-${i}.html`; // link to actual chapter page
        a.className = 'chapter-link';
        a.id = `chapter-${i}`;
        a.textContent = String(i).padStart(1,'0'); // display number
        if(i === currentChapter) a.classList.add('current');
        // click handler: normal navigation (opens link). For single page scrolling you can preventDefault and handle.
        chapterGrid.appendChild(a);
      }
    }

    // initial full grid
    buildGrid(1, totalChapters);

    /********** Arc list (list view) **********/
    const arcContainer = document.querySelector('.arc-items');
    function renderArcs(){
      arcContainer.innerHTML = '';
      arcs.forEach((arc, idx) => {
        const btn = document.createElement('button');
        btn.className = 'arc-item';
        btn.textContent = `${arc.name} (${arc.start}-${arc.end})`;
        btn.dataset.start = arc.start;
        btn.dataset.end = arc.end;
        btn.dataset.index = idx;
        // default active first arc
        if(idx === 0) btn.classList.add('active');
        btn.addEventListener('click', () => {
          // make active style
          document.querySelectorAll('.arc-item').forEach(x => x.classList.remove('active'));
          btn.classList.add('active');
          // rebuild grid for arc range
          buildGrid(arc.start, arc.end);
          // scroll grid into view on small screens
          document.querySelector('.chapter-card').scrollIntoView({behavior:'smooth', block:'start'});
        });
        arcContainer.appendChild(btn);
      });
    }
    renderArcs();

    /********** Find functionality (scroll + highlight) **********/
    const searchInput = document.getElementById('searchInput');
    const findBtn = document.getElementById('findBtn');

    function flashAndScroll(chNum){
      if(chNum < 1 || chNum > totalChapters){
        alert(`Chapter ${chNum} is out of range (1 - ${totalChapters})`);
        return;
      }

      // If the requested chapter is not currently in the grid range, find the arc it belongs to and switch to that arc
      const arcForChapter = arcs.find(a => chNum >= a.start && chNum <= a.end);
      if(arcForChapter){
        // activate the arc button
        document.querySelectorAll('.arc-item').forEach(b=>{
          b.classList.toggle('active', parseInt(b.dataset.start) === arcForChapter.start);
        });
        // rebuild grid for that arc
        buildGrid(arcForChapter.start, arcForChapter.end);
      }

      // small delay to ensure element exists after buildGrid
      setTimeout(()=>{
        const el = document.getElementById(`chapter-${chNum}`);
        if(!el){
          // not in DOM? (shouldn't happen) fallback to open link
          window.open(`chapters/chapter-${chNum}.html`, '_blank');
          return;
        }
        // scroll smoothly to element
        el.scrollIntoView({behavior:'smooth', block:'center'});
        // add found class
        el.classList.add('found');
        // remove highlight after 1.2s
        setTimeout(()=> el.classList.remove('found'), 1200);
      }, 80);
    }

    findBtn.addEventListener('click', ()=>{
      const val = parseInt(searchInput.value,10);
      if(Number.isInteger(val)) flashAndScroll(val);
      else alert('Enter a chapter number');
      searchInput.value = '';
    });

    // support Enter key
    searchInput.addEventListener('keydown', e=>{
      if(e.key === 'Enter'){
        const val = parseInt(searchInput.value,10);
        if(Number.isInteger(val)) flashAndScroll(val);
        else alert('Enter a chapter number');
        searchInput.value = '';
      }
    });

    /********** Extra: clicking chapter opens link - preserve default navigation **********/
    // (No changes needed. The anchor tags point to chapters/chapter-X.html)

    /********** Accessibility: allow hash linking to open highlight if loaded via #chapter-X **********/
    window.addEventListener('load', ()=>{
      const hash = location.hash;
      if(hash && hash.startsWith('#chapter-')){
        const n = parseInt(hash.replace('#chapter-',''),10);
        if(Number.isInteger(n)) flashAndScroll(n);
      }
    });
  </script>
</body>
</html>
